<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <title>Profiel</title>
    <link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" rel="stylesheet">

</head>
<body>

<div th:insert="~{ navbar :: navbar }"></div>

<div class="container" style="min-height: 100vh">

    <h2>Gegevens auth0:</h2>

    <p th:text="'Naam : '+${authprofile.get('name')}"></p>
    <p th:text="'Email :'+${authprofile.get('email')}"></p>
    <p th:text="'Nickname : '+${authprofile.get('nickname')}"></p>
    <p th:text="'Auth_id : '+${sub}"></p>

    <h2>Gegevens userdatabase:</h2>

    <!--    User is nog niet gemaakt in de local db-->
    <span th:unless="${userprofile} != null">
        <h3>We missen nog enkele gegevens. Vul je profiel aan.</h3>

        <form method="post" th:action="@{~/updateUser}">
                <div class="form-group">
                    <label for="naam" th:text="Familienaam"></label>
                    <input class="form-control" id="naam" name="naam" type="text">
                </div>
                <br>
                <div class="form-group">
                    <label for="voornaam" th:text="Voornaam"></label>
                    <input class="form-control" id="voornaam" name="voornaam" type="text">
                </div>
                <br>
                <div class="form-group">
                    <label for="email" th:text="E-mail"></label>
                    <input class="form-control" id="email" name="email" type="text">
                </div>
                <br>
                <div class="form-group">
                    <label for="tel" th:text="Telefoonnummer"></label>
                    <input class="form-control" id="tel" name="tel" type="text">
                </div>
                <br>
                <div class="form-group">
                    <label for="straat" th:text="Straat"></label>
                    <input class="form-control" id="straat" name="straat" type="text">
                </div>
                <br>
                <div class="form-group">
                    <label for="huisnummer" th:text="Huisnummer"></label>
                    <input class="form-control" id="huisnummer" name="huisnummer" type="text">
                </div>
                <br>
                <div class="form-group">
                    <label for="bus" th:text="Bus"></label>
                    <input class="form-control" id="bus" name="bus" type="text">
                </div>
                <br>
                <div class="form-group">
                    <label for="postcode" th:text="Postcode"></label>
                    <input class="form-control" id="postcode" name="postcode" type="text">
                </div>
                <br>
                <div class="form-group">
                    <label for="gemeente" th:text="Gemeente"></label>
                    <input class="form-control" id="gemeente" name="gemeente" type="text">
                </div>
                <br>

            <!-- BUTTON bevestig -->
            <button class="btn btn-primary" th:text="#{profiel.opslaan}" type="submit">
                <!-- T: Opslaan -->
            </button>
        </form>

    </span>

    <!--    User is al gemaakt in de local db-->
    <span th:if="${userprofile} != null">
        <p th:text="'Auth_id : '+${userprofile.auth_id}"></p>
        <p th:text="'Familienaam : '+${userprofile.familienaam}"></p>
        <p th:text="'Straat : '+${userprofile.straat}"></p>
        <p th:text="'Gemeente : '+${userprofile.gemeente}"></p>
        <h2 th:text="#{profiel.bestellingen}"></h2>

        <div style="margin-bottom: 5px" th:each="orders: ${userprofile.orders}">
            <div class="card">
                <div class="card-header"
                     th:text="'Bestelling referentie '+${orders.id}+ #{profiel.totaal}+${#numbers.formatDecimal(orders.totaalbedrag, 1, 2)}">
                </div>
                <div class="card-body">
                    <p class="card-text" th:each="detail: ${orders.orderDetails}"
                       th:text="${detail.naam}+' ~ â‚¬ '+${detail.prijs}"></p>
                </div>
                <div class="card-footer">
                    <small class="text-muted"
                           th:text="#{profiel.besteldop}+${#temporals.format(orders.datumAangemaakt, 'dd-MM-yyyy')}+ #{profiel.leveroptie}+(${orders.levering}? #{profiel.thuislevering} : #{profiel.ophalenwinkel})"></small>
                </div>

            </div>
        </div>
    </span>
</div>

<!-- FOOTER -->
<div th:insert="~{ footer :: footer }"></div>
</body>
</html>